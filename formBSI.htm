<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>REGISTRATION FORM</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #f8f9fa;
      padding: 30px;
    }
    .form-container {
      max-width: 750px;
      margin: auto;
      background: #fff;
      padding: 30px;
      border-radius: 10px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }.addressBSI{
      font-size:12px;
      margin-left:300px;
      margin-top:-100px;
      color:#0055aa
    }.addressBSI a{
        color:blue
    }
    h2 {
      text-align: center;
      color: #003366;
    }
    label {
      display: block;
      margin-top: 15px;
      font-weight: bold;
    }
    input, textarea {
      width: 100%;
      padding: 10px;
      margin-top: 5px;
      border: 1px solid #ccc;
      border-radius: 5px;
      font-size: 14px;
    }
    textarea {
      resize: vertical;
    }
    button {
      margin-top: 20px;
      background-color: #003366;
      color: #fff;
      padding: 12px 20px;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      font-size: 16px;
    }
    button:hover {
      background-color: #0055aa;
    }
    canvas {
      border: 1px solid #ccc;
      border-radius: 5px;
      width: 100%;
      height: 200px;
      margin-top: 5px;
    }
    .clear-btn {
     margin-top: 20px;
      background-color: #003366;
      color: #fff;
      padding: 12px 20px;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      font-size: 16px;
    }
    .clear-btn:hover {
       background-color: #0055aa;
    }
  </style>
</head>
<body>

<div class="form-container">
    <img src="images/collegeBSI.jpg" alt="BSI College Logo" width="180">
    <div class="addressBSI">
    <p>5th Floor, 33 Church Street, Cape Town City Centre, Cape Town, 8001</p>
    <p>Suite 102-N, 28 Saddle Dr, Woodmead Office Park, Sandton, Johannesburg, SA</p>
    <p>11th floor, 1108 Metlife, 391, Smith Street, Durban Central, 4001</p>
    <p>Head Office, Cape Town Branch Tel: +27 21 285 0213</p>
    <p>Johannesburg Branch Tel: +27 10 065 0687</p>
    <p>Tel & Whatsapp: +27 67 273 6847</p>
    <a href="index.html">www.bsisa.co.za</a>,
    <a href="mailto:info@bsisa.co.za">info@bsisa.co.za</a>

</div>
  <h2>REGISTRATION FORM</h2>

  <form action="https://formsubmit.co/tsakanimaheso@gmail.com" method="POST">


    <input type="hidden" name="_next" value="http://127.0.0.1:5500/index.html">
    <input type="hidden" name="_captcha" value="false">
     <input type="hidden" name="_cc" value="oumamaheso18@gmail.com">

    <label>Name & Surname</label>
    <input type="text" name="fullname" required>

    <label>Contact Details</label>
    <textarea name="contact_details" rows="2" required></textarea>

    <label>Username</label>
    <input type="text" name="username" required>

    <label>Gmail/Email Address</label>
    <input type="email" name="email" required>

    <label>Student Number</label>
    <input type="text" name="student_number" required>

    <label>Course Name</label>
    <input type="text" name="course_name" required>

    <label>Course Duration</label>
    <input type="text" name="course_duration" required>

    <label>Start Date</label>
    <input type="date" name="start_date" required>

    <label>Electronic Signature (use your mouse or finger)</label>
    <canvas id="signature-pad"></canvas>
    <input type="hidden" name="signature" id="signature-field">
    <button type="button" id="clear" class="clear-btn">Clear Signature</button>

    <button type="submit">Submit Registration</button>
  </form>
</div>
<script src="https://cdn.jsdelivr.net/npm/signature_pad@4.0.0/dist/signature_pad.umd.min.js"></script>
<script>
const canvas = document.getElementById('signature-pad');
const signaturePad = new SignaturePad(canvas);
const form = document.getElementById('registration-form');
const signatureField = document.getElementById('signature-field');

// Clear signature button
document.getElementById('clear').addEventListener('click', () => signaturePad.clear());

// Upload signature to Cloudinary
async function uploadSignature(dataURL) {
    const cloudName = 'dnmjzqjiy';          // replace with your Cloudinary cloud name
    const unsignedUploadPreset = 'signature_upload'; // replace with your preset

    // Convert Base64 to Blob
    const blob = await (await fetch(dataURL)).blob();
    const formData = new FormData();
    formData.append('file', blob);
    formData.append('upload_preset', unsignedUploadPreset);

    const response = await fetch(`https://api.cloudinary.com/v1_1/${cloudName}/upload`, {
        method: 'POST',
        body: formData
    });

    const data = await response.json();
    return data.secure_url; // public URL of the signature
}

// On form submit
form.addEventListener('submit', async function(e) {
    if (signaturePad.isEmpty()) {
        alert('Please sign before submitting.');
        e.preventDefault();
        return;
    }

    e.preventDefault(); // wait until upload finishes

    const dataURL = signaturePad.toDataURL('image/png');

    try {
        // Upload to Cloudinary
        const uploadedImageURL = await uploadSignature(dataURL);

        // Put a clickable link in the hidden field
        signatureField.value = `View or download signature: ${uploadedImageURL}`;

        // Now submit the form to FormSubmit
        form.submit();

    } catch (err) {
        alert('Failed to upload signature. Please try again.');
        console.error(err);
    }
});
</script>

